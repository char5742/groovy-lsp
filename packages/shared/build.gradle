plugins {
    id 'java-library'
}

description = 'Shared components for Groovy LSP modular architecture'

dependencies {
    // API Guardian for package visibility annotations
    compileOnly libs.apiguardian.api

    // jMolecules for DDD and architecture patterns
    api libs.bundles.jmolecules

    // Null Safety annotations
    api libs.jspecify

    // Guava for event bus implementation
    implementation libs.guava

    // Test dependencies
    testImplementation libs.bundles.lsp4j
    testImplementation libs.archunit
    testImplementation libs.jmolecules.integrations.archunit
}

jar {
    manifest {
        attributes(
            'Implementation-Title': 'Groovy LSP Shared Module',
            'Implementation-Version': project.version
        )
    }
}

// Export test classes for other modules
configurations {
    testOutput.extendsFrom testCompileClasspath
}

task testJar(type: Jar) {
    archiveClassifier = 'tests'
    from sourceSets.test.output
}

artifacts {
    testOutput testJar
}
